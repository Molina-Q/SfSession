{% extends 'base.html.twig' %}

{% block title %}Details session{% endblock %}
{% block metadesc %}Detail of the session {{ session }}{% endblock %}
{% block pageWrapper %}details-session{% endblock %}

{% block body %}

    <h2 class="secondary title">Details of the session</h2>
    <h1 class="primary-title">{{ session }}</h1>
    
    {# read and display all flash messages #}
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="flash-{{ label }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}

    {% if is_granted('ROLE_ADMIN') %}

        {{ form_start(addStudentForm) }}
            {{ form_errors(addStudentForm) }}
            <h3>Add Student</h3>
            <div class="form-content">
                {{ form_row(addStudentForm.Student) }}
            </div>
            <button type="submit" class="form-btn-submit" >Submit</button>
        {{ form_end(addStudentForm) }}

        {{ form_start(addProgrammeForm) }}
            {{ form_errors(addProgrammeForm) }}
            <h3>Add Programme</h3>
            <div class="form-content">
                {{ form_row(addProgrammeForm.Module) }}
                {{ form_row(addProgrammeForm.duration) }}
            </div>
            <button type="submit" class="form-btn-submit" >Submit</button>
        {{ form_end(addProgrammeForm) }}

    {% endif %} 

    <div class="row-unique table-header">
        <p class="table-item">Module</p>
        <p class="table-item">Duration</p>
    </div>

    <div id="table-information" class="table-list">
        <div class="table-row table-header">
            <h3 class="table-items">Additionnal information</h3>
        </div>

        <div class="table-row">
            <p>From</p> 
            <p>{{ session.dateStart | date('d/m/Y') }}</p>

            <p>To</p> 
            <p>{{ session.dateEnd | date('d/m/Y') }}</p>
        </div>

        <div class="table-row">
            <p>Places left</p> 
            <p>{{ session.nbPlace }}</p>

            <p>Places taken</p> 
            <p>{{ session.nbPlace }}</p>

            <p>Total places</p> 
            <p>{{ session.nbPlace }}</p>
        </div>

        <div class="table-row">
            <p>Formation</p>
            <strong>{{ session.Formation }}</strong>
        </div>
    </div>

    <div id="table-formation-module" class="table-list">

        {# {% for programme in session.programmes %}
        <div class="table-row table-header">
            <p class="table-item">{{ programme.module.Tag }}</p>
        </div>

        <div class="table-row">
            <p class="table-item">{{ programme }}</p>
            <p class="table-item">{{ programme.duration }} days</p>      
            
            <a href="{{ path('update_programme', {id: programme.id}) }}">
                <i class="fa-solid fa-pen-to-square"></i>
            </a>

            <a href="{{ path('delete_programme', {id: programme.id}) }}" class="deleteIcon">
                <i class="fa-solid fa-xmark"></i>
            </a>
        </div>   
        {% endfor %} #}
        
        
        {% for tag in tags %}
        <div class="table-row table-header">
            <p class="table-item">{{ tag }}</p>
        </div>
            {% for module in tag.modules %}
                {% for programme in module.programmes %}
                    <div class="table-row">
                        <p class="table-item">{{ programme }}</p>
                        <p class="table-item">{{ programme.duration }} days</p>      
                        
                        <a href="{{ path('update_programme', {id: programme.id}) }}">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </a>

                        <a href="{{ path('delete_programme', {id: programme.id}) }}" class="deleteIcon">
                            <i class="fa-solid fa-xmark"></i>
                        </a>
                    </div>   
                {% endfor %}
            {% endfor %}
        {% endfor %}

    </div>
{% endblock %}
